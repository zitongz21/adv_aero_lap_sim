function p = EngineFunction(rpm, engine)
if strcmpi(engine, 'gsx_r600')
    ENGINE = gsx_r600(); % f1_generic();
elseif strcmpi(engine, 'gsx_r601')
    ENGINE = gsx_r601(); % f1_generic();
elseif strcmpi(engine, 'f1_2012_generic')
    ENGINE = f1_generic();
elseif strcmpi(engine, 'cbr_600')
    ENGINE = cbr_600;
else
    error('Wrong Engine Specification');
end
    
    P = ENGINE(:,1).*ENGINE(:,2)/60*2*pi;
    p = interp1(ENGINE(:,1), P, rpm);

function ENGINE = gsx_r600()
ENGINE = [
%     5000, 39.18;...
%     6000, 40.73;...
%     6500, 43.14;...
%     7000, 45.24;...
%     7500, 47.11;...
%     8250, 47.45;...
%     8750, 46.99;...
%     9250, 47.32;...
%     9750, 47.28;...
%     10250,46.61; ...
5790	28.44;...
5800	28.49;...
5850	28.74;...
5900	29.07;...
6000	29.90;...
6100	30.85;...
6200	31.93;...
6300	33.17;...
6400	34.60;...
6500	36.23;...
6600	38.02;...
6700	39.89;...
6800	41.68;...
6900	43.31;...
7000	44.63;...
7100	45.63;...
7200	46.30;...
7300	46.78;...
7400	47.20;...
7500	47.61;...
7600	48.02;...
7700	48.43;...
7800	48.78;...
7900	49.02;...
8000	49.13;...
8100	49.11;...
8200	49.03;...
8300	48.90;...
8400	48.77;...
8500	48.66;...
8600	48.59;...
8700	48.58;...
8800	48.62;...
8900	48.70;...
9000	48.78;...
9100	48.88;...
9200	48.98;...
9300	49.07;...
9400	49.12;...
9500	49.17;...
9600	49.19;...
9700	49.19;...
9800	49.16;...
9900	49.12;...
10000	49.05;...
10100	48.95;...
10200	48.85;...
10300	48.72;...
10400	48.56;...
10500	48.38;...
10600	48.19;...
10700	48.00;...
10800	47.78;...
10900	47.52;...
11000	47.22;...
11100	46.90;...
11200	46.56;...
11300	46.20;...
11400	45.82;...
11500	45.42;...
11600	45.00;...
11700	44.61;...
11800	44.20;...
11900	43.78;...
12000	43.38;...
12100	42.99;...
12200	42.48;...
12300	42.12;...
12400	41.63;...
12500	40.95;...
12600	39.91;...
12700	38.20;...
    ];

function ENGINE = gsx_r601()
ENGINE = [
5790	30.80801162	;...
5800	30.73813627	;...
5850	30.39927158	;...
5900	30.15812487	;...
6000	29.9	;...
6100	29.83563718	;...
6200	29.976666	;...
6300	30.35447011	;...
6400	31.00018721	;...
6500	31.92470907	;...
6600	33.08868151	;...
6700	34.4125044	;...
6800	35.7363317	;...
6900	36.98007138	;...
7000	37.99338552	;...
7100	38.76569021	;...
7200	39.28615564	;...
7300	39.69370603	;...
7400	40.11701966	;...
7500	40.60452888	;...
7600	41.1644201	;...
7700	41.79463378	;...
7800	42.43286443	;...
7900	43.02656064	;...
8000	43.55292504	;...
8100	44.00891433	;...
8200	44.46123925	;...
8300	44.91636462	;...
8400	45.42050931	;...
8500	45.98964624	;...
8600	46.63950241	;...
8700	47.38555884	;...
8800	48.21305065	;...
8900	49.106967	;...
9000	50.0220511	;...
9100	50.97280022	;...
9200	51.93346571	;...
9300	52.88805295	;...
9400	53.8003214	;...
9500	54.70378456	;...
9600	55.56171	;...
9700	56.37711935	;...
9800	57.13278829	;...
9900	57.84124656	;...
10000	58.47477796	;...
10100	59.02542035	;...
10200	59.51496564	;...
10300	59.90495982	;...
10400	60.1867029	;...
10500	60.36124898	;...
10600	60.42940622	;...
10700	60.39173681	;...
10800	60.20855702	;...
10900	59.85993718	;...
11000	59.33570167	;...
11100	58.64542892	;...
11200	57.77845144	;...
11300	56.72385577	;...
11400	55.47048254	;...
11500	54.00692642	;...
11600	52.32153613	;...
11700	50.45241447	;...
11800	48.33741828	;...
11900	45.97415847	;...
12000	43.38	;...
12100	40.53206189	;...
12200	37.28721722	;...
12300	33.90209313	;...
12400	30.08307082	;...
12500	25.75628553	;...
12600	20.73762658	;...
12700	14.70273735	;...
    ];

function ENGINE = f1_generic()
ENGINE = [...
6000	125.00; ...
7000	150.00; ...
8000	200.00; ...
9000	240.00; ...
10000	270.00; ...
11000	300.00; ...
12000	340.00; ...
13000	350.00; ...
14000	340.00; ...
15000	330.00; ...
16000	325.00; ...
17000	312.00; ...
18000	296.75; ...
    ];

function ENGINE = cbr_600()
ENGINE = [
7245	53.6; ...
7457	53.7; ...
7664	55.2; ...
7875	57.1; ...
8078	57.1; ...
8287	56;   ...
8474	54.9; ...
8665	53.7; ...
8868	53.5; ...
9054	53.4; ...
9248	53.4; ...
9454	54.1; ...
9669	55.4; ...
9889	57.6; ...
10114	58.5; ...
10333	59.3; ...
10540	59.6; ...
10759	59.2; ...
10966	58.3; ...
11162	57.6; ...
11371	56.6; ...
11562	55.8; ...
11759	55;   ...
11950	54.2; ...
12133	53.2; ...
12320	51.9; ...
12490	50.6; ...
12665	49;   ...
12830	47.8; ...
12986	46.6; ...
13142	45.3; ...
13269	42.4; ...
13354	37.2; ...
13410	28.8; ...
13442	21.8; ...
13455	14.4; ...
13460	8.8;  ...
];