ENGINE = [
5790	28.44;...
5800	28.49;...
5850	28.74;...
5900	29.07;...
6000	29.90;...
6100	30.85;...
6200	31.93;...
6300	33.17;...
6400	34.60;...
6500	36.23;...
6600	38.02;...
6700	39.89;...
6800	41.68;...
6900	43.31;...
7000	44.63;...
7100	45.63;...
7200	46.30;...
7300	46.78;...
7400	47.20;...
7500	47.61;...
7600	48.02;...
7700	48.43;...
7800	48.78;...
7900	49.02;...
8000	49.13;...
8100	49.11;...
8200	49.03;...
8300	48.90;...
8400	48.77;...
8500	48.66;...
8600	48.59;...
8700	48.58;...
8800	48.62;...
8900	48.70;...
9000	48.78;...
9100	48.88;...
9200	48.98;...
9300	49.07;...
9400	49.12;...
9500	49.17;...
9600	49.19;...
9700	49.19;...
9800	49.16;...
9900	49.12;...
10000	49.05;...
10100	48.95;...
10200	48.85;...
10300	48.72;...
10400	48.56;...
10500	48.38;...
10600	48.19;...
10700	48.00;...
10800	47.78;...
10900	47.52;...
11000	47.22;...
11100	46.90;...
11200	46.56;...
11300	46.20;...
11400	45.82;...
11500	45.42;...
11600	45.00;...
11700	44.61;...
11800	44.20;...
11900	43.78;...
12000	43.38;...
12100	42.99;...
12200	42.48;...
12300	42.12;...
12400	41.63;...
12500	40.95;...
12600	39.91;...
12700	38.20;...
    ];
power = ENGINE(:,2);
rpm = ENGINE(:,1);

torque_delta = [0;-3;9;0];
torque_delta_rpm = [5790;8500;10000;12700;]./1000;
A = zeros(8);
for i = 1:8
    A(1:4,i) = torque_delta_rpm.^(8-i);
    A(5:8,i) = (8-i)*torque_delta_rpm.^(7-i);
end
A(5:8,end) = 0;

torque_delta_c = A \ [torque_delta; 0; 0;0;0];
T_delta = [ (rpm/1000).^7, (rpm/1000).^6, (rpm/1000).^5, ...
            (rpm/1000).^4, (rpm/1000).^3, (rpm/1000).^2, ...
            (rpm/1000),    rpm.^0] * torque_delta_c;
ENGINE(:,2) = power + T_delta .* rpm * 2 * pi / 60 / 1000;
plot(rpm, power, rpm, ENGINE(:,2));